{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export const createGalleryItemMarkup = galleryItems => {\n  return galleryItems\n    .map(\n      ({\n        id,\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `<li class=\"gallery-item\">\n   <a class=\"gallery-link\" href=\"${largeImageURL}\">\n    <img\n    id=${id}\n      class=\"gallery-image\"\n      src=\"${webformatURL}\"\n      alt=\"${tags}\"\n    />\n   \n    </a>\n    <div class=\"image-properties\">\n      <div class=\"property-item\">\n        <h3 class=\"image-property-title\">Likes</h3>\n        <p class=\"image-property-data\">${likes}</p>\n      </div>\n      <div class=\"property-item\">\n        <h3 class=\"image-property-title\">Views</h3>\n        <p class=\"image-property-data\">${views}</p>\n      </div>\n      <div class=\"property-item\">\n        <h3 class=\"image-property-title\">Comments</h3>\n        <p class=\"image-property-data\">${comments}</p>\n      </div>\n      <div class=\"property-item\">\n        <h3 class=\"image-property-title\">Downloads</h3>\n        <p class=\"image-property-data\">${downloads}</p>\n      </div>\n    </div>\n </li>`\n    )\n    .join('');\n};\n","import axios from 'axios';\nimport { createGalleryItemMarkup } from './render-functions';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\nconst myApiKey = '43776865-31502832095c6a436255fe0a5';\n\nexport const fetchPhotosByQuery = async (searchQuery, page) => {\n  const response = await axios.get('/', {\n    params: {\n      key: myApiKey,\n      q: searchQuery,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      page: page,\n      per_page: 15,\n    },\n  });\n\n  return response.data;\n};\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { createGalleryItemMarkup } from './js/render-functions.js';\nimport { fetchPhotosByQuery } from './js/pixabay-api.js';\n\nconst searchFormEl = document.querySelector('.search-form');\nconst loaderEl = document.querySelector('.loader');\nlet galleryEl = document.querySelector('.gallery');\nconst moreBtnEl = document.querySelector('.more-btn');\n\nlet totalPages = 0;\nlet imageCurrentPage = 1;\nlet per_page = 15;\nlet searchQuery = null;\n\nconst handleSubmit = async event => {\n  event.preventDefault();\n\n  const form = event.currentTarget;\n\n  searchQuery = form.elements.search.value.trim();\n\n  galleryEl.innerHTML = '';\n  loaderEl.classList.remove('is-hidden');\n\n  imageCurrentPage = 1;\n\n  if (searchQuery === '') {\n    iziToast.show({\n      message: 'Input field can not be empty',\n      position: 'topRight',\n      timeout: 2000,\n      color: 'red',\n    });\n    form.reset();\n    loaderEl.classList.add('is-hidden');\n    return;\n  }\n\n  try {\n    const { total, hits } = await fetchPhotosByQuery(\n      searchQuery,\n      imageCurrentPage\n    );\n\n    if (total === 0) {\n      iziToast.show({\n        message: 'Sorry, there are no images for this query',\n        position: 'topRight',\n        timeout: 2000,\n        color: 'red',\n      });\n      loaderEl.classList.add('is-hidden');\n      moreBtnEl.classList.add('btn-is-hidden');\n      return;\n    }\n\n    galleryEl.insertAdjacentHTML('beforeend', createGalleryItemMarkup(hits));\n    moreBtnEl.classList.remove('btn-is-hidden');\n\n    totalPages = Math.ceil(total / per_page);\n\n    if (hits.length < per_page) {\n      moreBtnEl.classList.add('btn-is-hidden');\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        timeout: 2000,\n        color: 'red',\n      });\n    } else {\n      moreBtnEl.classList.remove('btn-is-hidden');\n    }\n    lightbox.refresh();\n    // smoothScroll();\n  } catch {\n    iziToast.show({\n      message: 'An error occurred while fetching images',\n      position: 'topRight',\n      timeout: 2000,\n      color: 'red',\n    });\n  } finally {\n    loaderEl.classList.add('is-hidden');\n  }\n  form.reset();\n};\n\nconst smoothScroll = () => {\n  const lastItemEl = galleryEl.querySelector('li.gallery-item:last-child');\n  const imageItemHeight = lastItemEl.getBoundingClientRect().height;\n  const scrollHeight = imageItemHeight * 2;\n\n  window.scrollBy({\n    top: 730,\n    left: 0,\n    behavior: 'smooth',\n  });\n};\n\nasync function handleMoreBtn(event) {\n  try {\n    imageCurrentPage += 1;\n    loaderEl.classList.remove('is-hidden');\n\n    const { hits } = await fetchPhotosByQuery(searchQuery, imageCurrentPage);\n\n    galleryEl.insertAdjacentHTML('beforeend', createGalleryItemMarkup(hits));\n\n    lightbox.refresh();\n    smoothScroll();\n\n    if (imageCurrentPage >= totalPages) {\n      moreBtnEl.classList.add('btn-is-hidden');\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        timeout: 2000,\n        color: 'red',\n      });\n    }\n  } catch (error) {\n    iziToast.show({\n      message: 'An error occurred while fetching more images.',\n      position: 'topRight',\n      timeout: 2000,\n      color: 'red',\n    });\n    moreBtnEl.classList.add('is-hidden');\n  } finally {\n    loaderEl.classList.add('is-hidden');\n  }\n}\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nmoreBtnEl.addEventListener('click', handleMoreBtn);\nsearchFormEl.addEventListener('submit', handleSubmit);\n"],"names":["createGalleryItemMarkup","galleryItems","id","webformatURL","largeImageURL","tags","likes","views","comments","downloads","axios","myApiKey","fetchPhotosByQuery","searchQuery","page","searchFormEl","loaderEl","galleryEl","moreBtnEl","totalPages","imageCurrentPage","per_page","handleSubmit","event","form","iziToast","total","hits","lightbox","smoothScroll","handleMoreBtn","SimpleLightbox"],"mappings":"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"}